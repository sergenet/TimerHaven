<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Global Weather — TimerHaven</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Check weather for cities worldwide instantly.">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
  <style>
    body { background: #f4f7fb; font-family: 'Montserrat', Arial, sans-serif; }
    .main-container { max-width: 1200px; margin: 2em auto; display: flex; justify-content: center; align-items: center; min-height: 90vh; }
    .center-row { display: flex; flex-direction: row; justify-content: center; align-items: flex-start; gap: 2em; width: 100%; }
    .article-card { background: #fff; border-radius: 16px; box-shadow: 0 2px 12px #e0e7ef; width: 330px; min-width: 200px; min-height: 340px; height: 340px; display: flex; flex-direction: column; justify-content: space-between; align-items: flex-start; padding: 2em 1.3em 1em 1.3em; text-align: left; overflow: hidden; box-sizing: border-box; }
    .article-card h2 { font-size: 1.35em; font-weight: 700; margin-bottom: 0.4em; display: flex; align-items: center; gap: 0.3em; }
    .article-card ul, .article-card ol { margin-left: 1em; font-size: 1em; margin-bottom: 0.2em; padding-right: 0.2em; word-break: break-word; }
    .article-card .btn { align-self: stretch; font-weight: 600; border-radius: 8px; margin-top: 0.2em; margin-bottom: 0; box-sizing: border-box; }
    .tool-card { background: #fff; border-radius: 16px; box-shadow: 0 2px 12px #e0e7ef; width: 410px; min-width: 240px; min-height: 330px; display: flex; flex-direction: column; justify-content: flex-start; align-items: stretch; padding: 2em 1.5em 1em 1.5em; text-align: left; position: relative; z-index: 1; }
    .tool-card h3 { font-size: 1.45em; font-weight: 700; margin-bottom: 0.7em; }
    .weather-form-row { display: flex; flex-direction: row; gap: 0.5em; margin-bottom: 1em; align-items:center;}
    #cityDropdown, #cityInput { min-width: 120px; }
    .weather-result { margin-top: 1em; background: #f7fafc; border-radius: 7px; padding: 1em; font-size:1.15em;}
    .btn { font-weight: 600; border-radius: 7px; padding: 0.4em 1.3em;}
    .action-row {
      display: flex;
      flex-direction: row;
      gap: 0.7em;
      margin-bottom: 0.2em;
      margin-top: 0.2em;
    }
    #getWeatherBtn {
      width: 175px;
      height: 42px;
      font-size: 1.07em;
      background: #157af6;
      color: #fff;
      border: none;
      border-radius: 8px;
      font-weight: 600;
      box-shadow: 0 2px 8px #e0e7ef;
      cursor: pointer;
      transition: background 0.2s;
      display:inline-block;
      text-align: center;
    }
    #getWeatherBtn:hover { background: #1a97fa; }
    #useLocationBtn {
      background: #444;
      color: #fff;
      border-radius: 8px;
      font-size: 1.07em;
      font-weight: 600;
      border: none;
      padding: 0.4em 1.1em;
      width: 175px;
      height: 42px;
      display: inline-flex;
      align-items: center;
      gap: 0.4em;
      cursor: pointer;
      transition: background 0.2s;
      text-align: center;
      justify-content: center;
    }
    #useLocationBtn:hover { background: #222; }
    @media (max-width: 750px) {
      #getWeatherBtn, #useLocationBtn { width: 100%; margin-left:0; }
      .weather-form-row { flex-direction: column; align-items: stretch; }
      .action-row { flex-direction: column; gap: 0.5em; }
    }
    .back-link { display: inline-block; margin-bottom: 1em; color: #007bff; text-decoration: none; font-weight: bold; font-size: 1em; }
    .back-link:hover { text-decoration: underline; }
    @media (max-width: 1100px) { .main-container{padding:0 8px;} .center-row{gap:1em;} .tool-card,.article-card{width:97vw;max-width:540px;height:auto;} }
    @media (max-width: 800px) { .main-container{padding:0;} .center-row{flex-direction:column;align-items:center;} .tool-card,.article-card{width:98vw;max-width:540px;height:auto;} .article-card { display: none !important; } }
    details[open] summary::after { content: " ▲"; font-size: 0.9em; }
    details summary { cursor: pointer; padding: 0.35em 0; font-weight: bold; font-size: 1.09em; }
    details:not([open]) summary::after { content: " ▼"; font-size: 0.9em; }
    footer {
      width: 100%;
      margin-top: 2em;
      padding: 1em 0 1.5em 0;
      text-align: center;
      font-size: 1.08em;
      color: #555;
      background: none;
    }
    footer a {
      color: #185a9d;
      text-decoration: none;
      margin: 0 0.6em;
    }
    footer a:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <div class="main-container">
    <div class="center-row">
      <!-- Article 1 (desktop only) -->
      <div class="article-card">
        <div>
          <h2 style="color:#185a9d;"><i class="fa fa-cloud-sun"></i> How to Use Weather Tool</h2>
          <ol>
            <li><b>Select or enter a city:</b> Choose from the dropdown or type your own.</li>
            <li><b>Use location:</b> Click the <b>Use My Location</b> button to use your device’s location.</li>
            <li><b>View results:</b> Click <b>Get Weather</b> to see current weather info.</li>
          </ol>
        </div>
        <a href="weather-how-to.html" class="btn btn-outline-primary btn-sm" style="margin-bottom:0;">Read Full Article</a>
      </div>
      <!-- Weather Tool Card -->
      <div class="tool-card">
        <a href="index.html" class="back-link"><i class="fa fa-arrow-left"></i> Back to Main Menu</a>
        <h3><i class="fa fa-cloud-sun"></i> Global Weather</h3>
        <form id="weatherForm" autocomplete="off">
          <div class="weather-form-row">
            <select id="cityDropdown" class="form-select" title="Select a city">
              <option value="">Select city...</option>
              <option value="New York">New York</option>
              <option value="London">London</option>
              <option value="Paris">Paris</option>
              <option value="Berlin">Berlin</option>
              <option value="Tokyo">Tokyo</option>
              <option value="Sydney">Sydney</option>
              <option value="São Paulo">São Paulo</option>
              <option value="Moscow">Moscow</option>
              <option value="Dubai">Dubai</option>
              <option value="Istanbul">Istanbul</option>
              <option value="Johannesburg">Johannesburg</option>
              <option value="Toronto">Toronto</option>
              <option value="Mexico City">Mexico City</option>
              <option value="Los Angeles">Los Angeles</option>
              <option value="Mumbai">Mumbai</option>
              <option value="Cairo">Cairo</option>
              <option value="Singapore">Singapore</option>
              <option value="Hong Kong">Hong Kong</option>
              <option value="Bangkok">Bangkok</option>
              <option value="Seoul">Seoul</option>
              <option value="San Francisco">San Francisco</option>
              <option value="Rome">Rome</option>
              <option value="Kolkata">Kolkata</option>
              <option value="Jakarta">Jakarta</option>
              <option value="Madrid">Madrid</option>
              <option value="Cape Town">Cape Town</option>
              <option value="Lagos">Lagos</option>
              <option value="Melbourne">Melbourne</option>
              <option value="Beijing">Beijing</option>
              <option value="Chicago">Chicago</option>
              <option value="Vancouver">Vancouver</option>
              <option value="Auckland">Auckland</option>
              <option value="Hanoi">Hanoi</option>
              <option value="Manila">Manila</option>
              <option value="Warsaw">Warsaw</option>
              <!-- Add more as desired -->
            </select>
            <input type="text" id="cityInput" class="form-control" placeholder="Or enter city..." title="Type any city">
          </div>
          <div class="action-row">
            <button type="submit" class="btn" id="getWeatherBtn">Get Weather</button>
            <button type="button" id="useLocationBtn"><i class="fa fa-location-arrow"></i> Use My Location</button>
          </div>
        </form>
        <div id="weatherResult" class="weather-result"></div>
        <details style="margin-top:1em;">
          <summary><b>FAQs</b></summary>
          <ul style="padding-left: 1em;">
            <li><b>How accurate is the weather?</b> Data is provided by OpenWeatherMap or similar APIs.</li>
            <li><b>Can I use my location?</b> Yes, click <b>Use My Location</b> to get local weather.</li>
            <li><b>Can I enter any city?</b> Yes! Type any city in the input box.</li>
          </ul>
        </details>
      </div>
      <!-- Article 2 (desktop only) -->
      <div class="article-card">
        <div>
          <h2 style="color:#185a9d;"><i class="fa fa-lightbulb" style="color:#43cea2;"></i> Weather Productivity Tips</h2>
          <ul>
            <li><b>Plan ahead:</b> Check the weather before traveling or events.</li>
            <li><b>Use location:</b> Get instant local weather updates.</li>
            <li><b>Save time:</b> Use the dropdown for popular cities.</li>
          </ul>
        </div>
        <a href="weather-tips.html" class="btn btn-outline-primary btn-sm" style="margin-bottom:0;">Read Full Article</a>
      </div>
    </div>
  </div>
  <script>
    function fetchWeather(city) {
      if (!city) {
        document.getElementById('weatherResult').innerHTML = '<span style="color:#b00;">Please select or enter a city.</span>';
        return;
      }
      // Use backend proxy, NOT OpenWeatherMap directly
      fetch(`/weather?city=${encodeURIComponent(city)}`)
        .then(r => r.json())
        .then(data => {
          if (data.cod !== 200 && data.error) {
            document.getElementById('weatherResult').innerHTML = `<span style="color:#b00;">${data.error}</span>`;
            return;
          }
          if (data.cod !== 200) {
            document.getElementById('weatherResult').innerHTML = `<span style="color:#b00;">Could not find weather for "${city}".</span>`;
            return;
          }
          document.getElementById('weatherResult').innerHTML =
            `<b>${data.name}, ${data.sys.country}</b><br>
            Weather: ${data.weather[0].description}<br>
            Temperature: ${data.main.temp}&deg;C<br>
            Humidity: ${data.main.humidity}%<br>
            Wind: ${data.wind.speed} m/s`;
        })
        .catch(() => {
          document.getElementById('weatherResult').innerHTML = '<span style="color:#b00;">Error fetching weather data.</span>';
        });
    }

    document.getElementById('cityDropdown').addEventListener('change', function() {
      document.getElementById('cityInput').value = this.value;
      if (this.value) fetchWeather(this.value);
    });

    document.getElementById('cityInput').addEventListener('input', function() {
      const val = this.value.trim();
      const dd = document.getElementById('cityDropdown');
      let found = false;
      for (let i = 0; i < dd.options.length; i++) {
        if (dd.options[i].value.toLowerCase() === val.toLowerCase()) {
          dd.selectedIndex = i;
          found = true;
          break;
        }
      }
      if (!found) dd.selectedIndex = 0;
    });

    document.getElementById('weatherForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const city = document.getElementById('cityInput').value.trim() || document.getElementById('cityDropdown').value;
      fetchWeather(city);
    });

    // Use My Location button (uses Geolocation API)
    document.getElementById('useLocationBtn').addEventListener('click', function() {
      if (!navigator.geolocation) {
        document.getElementById('weatherResult').innerHTML = '<span style="color:#b00;">Geolocation not supported.</span>';
        return;
      }
      navigator.geolocation.getCurrentPosition(function(pos) {
        const lat = pos.coords.latitude;
        const lon = pos.coords.longitude;
        // Use backend proxy for lat/lon queries
        fetch(`/weather?lat=${lat}&lon=${lon}`)
          .then(r => r.json())
          .then(data => {
            if (data.cod !== 200 && data.error) {
              document.getElementById('weatherResult').innerHTML = `<span style="color:#b00;">${data.error}</span>`;
              return;
            }
            if (data.cod !== 200) {
              document.getElementById('weatherResult').innerHTML = `<span style="color:#b00;">Could not find weather for your location.</span>`;
              return;
            }
            document.getElementById('weatherResult').innerHTML =
              `<b>${data.name}, ${data.sys.country}</b><br>
              Weather: ${data.weather[0].description}<br>
              Temperature: ${data.main.temp}&deg;C<br>
              Humidity: ${data.main.humidity}%<br>
              Wind: ${data.wind.speed} m/s`;
            document.getElementById('cityInput').value = data.name;
            document.getElementById('cityDropdown').value = '';
          })
          .catch(() => {
            document.getElementById('weatherResult').innerHTML = '<span style="color:#b00;">Error fetching weather data.</span>';
          });
      }, function() {
        document.getElementById('weatherResult').innerHTML = '<span style="color:#b00;">Unable to get your location.</span>';
      });
    });
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/js/all.min.js"></script>

  <footer>
    &copy; 2025 TimerHaven. All tools are free and privacy-friendly.<br>
    <a href="privacy.html">Privacy Policy</a> &bull;
    <a href="terms.html">Terms</a> &bull;
    <a href="contact.html">Contact</a>
  </footer>
</body>
</html>